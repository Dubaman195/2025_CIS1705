<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Robot Juice | Products</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>Robot Juice</h1>
      <p>fictitious cycle lubricants</p>
      <nav>
        <a href="index.html">Home</a>
        <a href="products.html" class="active">Products</a>
        <a href="#">Protect</a>
        <a href="#">Stockist's</a>
        <a href="#">Events</a>
        <a href="#">Reviews</a>
      </nav>
    </header>
    <main>
      <section id="products">
        <div class="prod-gallery">
          <img
            src="robot-juice-images/prod-thumb1.jpg"
            alt="Thumbnail of bike oil"
            class="prod-thumb"
          />
          <img
            src="robot-juice-images/prod-thumb2.jpg"
            alt="Thumbnail of bike chains"
            class="prod-thumb"
          />
          <img
            src="robot-juice-images/prod-thumb3.jpg"
            alt="Thumbnail of oil splatter"
            class="prod-thumb"
          />
        </div>
        <img
          src="robot-juice-images/robotjuicebikeoil.jpg"
          alt="Full image of bike oil"
        />
        <div class="prod-info">
          <h2>Bike Oil</h2>
          <p>£99.99</p>
          <form>
            <select id="size" name="size">
              <option value="" disabled selected>Size</option>
              <option value="100ml">100ml</option>
              <option value="250ml">250ml</option>
              <option value="500ml">500ml</option>
            </select>

            <select id="qty" name="qty">
              <option value="" disabled selected>Qty</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
            <button type="submit">BUY NOW</button>
            <p><a href="#">FIND NEAREST STOCKIST</a></p>
            <p>
              <a href="#">SHARE</a>
              <img src="robot-juice-images/facebook.jpg" alt="Facebook" />
              <img src="robot-juice-images/twitter.jpg" alt="Twitter" />
              <img src="robot-juice-images/email.jpg" alt="Email" />
            </p>
            <p>
              Robot Jucie bike oil for bicylces stops rust and other corrosion
              from starting. Applied to already corroding metals it breaks down
              the corrosion and starts preventing it form building up and
              protects from the point of contact.
            </p>
          </form>
        </div>
      </section>

      <div class="spacer"></div>

      <section id="similar-products">
        <h2>Similar Products</h2>
        <div class="sim-prod-gallery">
          <a>
            <img src="robot-juice-images/simprod.jpg" alt="Similar product 1" />
          </a>
          <a>
            <img src="robot-juice-images/simprod.jpg" alt="Similar product 2" />
          </a>
          <a>
            <img src="robot-juice-images/simprod.jpg" alt="Similar product 3" />
          </a>
          <a>
            <img src="robot-juice-images/simprod.jpg" alt="Similar product 4" />
          </a>
          <a>
            <img src="robot-juice-images/simprod.jpg" alt="Similar product 5" />
          </a>
          <a>
            <img src="robot-juice-images/simprod.jpg" alt="Similar product 6" />
          </a>
        </div>
      </section>
      <div class="spacer"></div>
      <section id="reviews-container">
        <h2>Product Reviews *****</h2>
        <div id="reviews"></div>
        <button
          id="show-all-btn"
          onclick="renderReviews(reviews); hideElement('show-all-btn')"
        >
          Show All Reviews
        </button>
      </section>
    </main>
    <footer>
      <div class="footer-top">
        <article class="f-review-container">
          <img
            src="robot-juice-images/cyclemagazine.jpg"
            alt="Front page of the Cycling Magazine"
          />
          <div class="f-review">
            <h2>Latest Reviews</h2>
            <p>
              Cycling magazine has given Robot Juice a 5 star rating in its
              latest reviews of dry lubricants. Robot Juice Dry lube was rated
              the highest out of over 40 top brand dry lubs.
            </p>
          </div>
        </article>
        <article class="links">
          <h2>Links</h2>
          <a href="#">Edge Hill University</a>
          <a href="#">Dave Walsh</a>
          <a href="https://twitter.com/walsh_d">https://twitter.com/walsh_d</a>
          <a href="#">CIS1110 - Web Design and Development module</a>
        </article>
      </div>
      <div class="footer-bottom">
        <div class="footer-left">
          <p>
            Roboj Juice Fictitious Products Not Ltd. Unit 9¾, Privet Drive,
            Little Whingeing, Surrey, DN18 5RP
          </p>
          <p>Telephone: +44 (0)1695 657648. Email: walshd@edgehill.ac.uk</p>
        </div>
        <div class="footer-right">
          <p>
            <a href="#">Contact Us</a> | <a href="#">Privacy</a> |
            <a href="#">Terms & Conditions</a> | <a href="#">Accessibility</a>
          </p>
          <p>Copyright © 2018 Dave Walsh. Design by Dave Walsh.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
<script>
  var reviewsContainer = document.getElementById("reviews");

  var api_url = "https://cis1110apicw.computing.edgehill.ac.uk/reviews";

  var reviews = [];

  window.addEventListener("load", function () {
    fetch(api_url)
      .then((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok" + response.statusText);
        }
        return response.json();
      })
      .then((data) => {
        reviews = data;
        renderReviews(reviews.slice(0, 5));
      })
      .catch((error) => {
        console.error(
          "There has been a problem with the fetch operation:",
          error
        );
        reviewsContainer.innerHTML = "<p>Could not load reviews.</p>";
      });
  });

  function renderReviews(reviewsToRender) {
    reviewsContainer.innerHTML = "";
    reviewsToRender.forEach((review) => {
      var ratingStars = "";
      for (let i = 0; i < 5; i++) {
        if (i < review.rating) {
          ratingStars += "<span class='star-filled'>*</span>";
        } else {
          ratingStars += "<span class='star-empty'>*</span>";
        }
      }

      reviewsContainer.innerHTML += `
      <div class="review">
        <img src="robot-juice-images/reviewicon1.jpg" alt="Review icon">
        <div class="review-title">
          <h2 class="rating">${ratingStars}</h2>
          <h3 class="review-name">${review.nickname}</h3>
        </div>
        <p class="review-content">${review.review}</p>
      </div>`;
    });
  }

  function hideElement(elementId) {
    var element = document.getElementById(elementId);
    element.style.display = "none";
  }
</script>
